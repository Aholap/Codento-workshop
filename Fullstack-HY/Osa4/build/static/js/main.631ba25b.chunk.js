(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,n){e.exports=n(69)},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(18),o=n.n(l),u=n(2),c=n.n(u),i=n(5),s=n(4),m=n(12),g=n(1),d=n(10),f=n.n(d),b="http://localhost:3003/blogs",p=null,v=function(e){p="bearer ".concat(e)},E=function(){return f.a.get(b).then(function(e){return e.data})},h=function(e){var t={headers:{Authorization:p}};return console.log(e),f.a.post(b,e,t).then(function(e){return e.data})},O=function(e,t){return console.log(e),console.log(b+"/"+t),f.a.put(b+"/"+t,e).then(function(e){return e.data})},j=function(e){var t={headers:{Authorization:p}};return console.log(e),f.a.delete(b+"/"+e,t).then(function(e){return e.data})},y=[],w=function(){return function(){var e=Object(i.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:n=e.sent,console.log(n),t({type:"INIT_BLOGS",data:n});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},k=function(e){return console.log(e),function(){var t=Object(i.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"LIKE",id:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"INIT_BLOGS":return console.log("initializing blogs"),console.log(t.data),t.data;case"NEW_BLOG":return console.log(t.data),console.log(e),e.concat(t.data);case"NEW_COMMENT":console.log(e);var n=e.find(function(e){return e.id==t.id});console.log(n);var a=[].concat(e);return a.map(function(e){e.id==t.id&&(e=n)}),a;case"LIKE":var r=e.find(function(e){return e.id==t.id});console.log(r),r.likes=r.likes+1;var l=[].concat(e);return l.map(function(e){e.id==t.id&&(e=r)}),l;case"DELETE_BLOG":return console.log(t),e.filter(function(e){return e.id!=t.id});default:return e}},C=function(e){return console.log(e),function(){var t=Object(i.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"NEW_USER",user:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_USER":return console.log(t.user),t.user;default:return e}},x=Object(g.b)(function(e){return console.log(e),{blogs:e.blogs,message:e.message,user:e.user}})(function(e){var t=null,n=1;return e.blogs.map(function(a){a.user.username==e.user.username&&(t+=1,n=a.user.id)}),r.a.createElement("div",null,r.a.createElement("h1",null,"Users"),r.a.createElement("div",null,"blogs created"),r.a.createElement("div",null,r.a.createElement(m.b,{to:"/users/"+n}," ",e.user.username+":  "+t," ")))}),N=Object(g.b)(null,{setU:C})(x),L=Object(g.b)(null,{initializeBlogs:w})(N),_=n(14),I=Object(g.b)(null,{addComment:function(e,t){return function(){var n=Object(i.a)(c.a.mark(function n(a){return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a({type:"NEW_COMMENT",com:e,id:t});case 1:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}})(function(e){var t=Object(a.useState)([]),n=Object(s.a)(t,2),l=n[0],o=n[1];console.log(e.blog);var u=Object(a.useState)(""),m=Object(s.a)(u,2),g=m[0],d=m[1];console.log(e);var f=function(){var t=Object(i.a)(c.a.mark(function t(){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e.blog.id),(n=e.blog).comments=n.comments.concat(g),console.log(n),t.next=6,O(n,e.blog.id);case 6:o(e.blog.comments);case 7:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)(function(){o(e.blog.comments)},[]),console.log(g),r.a.createElement("div",null,r.a.createElement("input",{value:g,type:"text",onChange:function(e){d(e.target.value)}}),r.a.createElement("button",{onClick:function(){return f()}},"Add comment"),l.map(function(e){return r.a.createElement("li",null,e)}))}),T=Object(g.b)(function(e){return{blogs:e.blogs,message:e.message,user:e.user}})(I),U=Object(g.b)(function(e){return{blogs:e.blogs,message:e.message,user:e.user}})(function(e){var t=Object(_.e)().id;console.log(t),console.log(e.blogs);var n=e.blogs.find(function(e){return e.id==t});console.log(n);return null==n?null:r.a.createElement("div",null,r.a.createElement("h1",null,n.title+" "+n.author),r.a.createElement("div",null,n.url),r.a.createElement("div",null,"likes "," "+n.likes," ",r.a.createElement("button",{onClick:function(){return function(t){console.log(t.user);var n={title:t.title,author:t.author,url:t.author,likes:t.likes,user:t.user},a=t.id;O(n,a),e.like(a)}(n)}},"like")),r.a.createElement("div",null,"added by "," "+n.user.name),r.a.createElement("div",null,r.a.createElement("h3",null,"comments"),r.a.createElement("div",null,r.a.createElement(T,{blog:n}))))}),W=Object(g.b)(null,{like:k})(U),G=n(6),z=function(e){return f.a.post("http://localhost:3003/login",e).then(function(e){return e.data})};z.propTypes={baseUrl:n.n(G).a.string.isRequired};var A=z,M=function(e){e.user,e.blog;var t=e.deleteBlog;return r.a.createElement("button",{type:"submit",onClick:t},"remove")},D=function(e){var t=e.blg,n=e.user,l=e.likeBlog,o=e.deleteBlog,u=Object(a.useState)(!1),c=Object(s.a)(u,2),i=c[0],g=c[1],d=Object(a.useState)(0),f=Object(s.a)(d,2),b=(f[0],f[1],{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5});return console.log(t),!1===i?r.a.createElement("div",{"data-testid":"klikkeri",style:b,onClick:function(){return g(!1===i)}},r.a.createElement(m.b,{to:"/blogs/"+t.id}," ",t.title," ",t.author," ")):r.a.createElement("div",null,r.a.createElement("div",{style:b,onClick:function(){return g(!1===i)}},r.a.createElement("div",null,console.log(t),"Title: ",t.title),r.a.createElement("div",null,"Author: ",t.author),r.a.createElement("div",null,"Likes: ",t.likes," ",r.a.createElement("button",{onClick:function(){return l(t)}},"like")),r.a.createElement("div",null,"Url: ",t.url),r.a.createElement("div",null,"Comments ",t.comments)),r.a.createElement(M,{deleteBlog:function(){return o(t)},user:n,blog:t}))},R=function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),r=n[0],l=n[1];return{type:e,value:r,onChange:function(e){l(e.target.value)},reset:function(e){e.preventDefault(),l("")}}},J=(n(68),function(e){var t=e.title,n=e.url,a=e.author,l=e.addBlog;return r.a.createElement("div",null,"      ",r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:l},r.a.createElement("div",null,"title:",r.a.createElement("input",{type:t.type,value:t.value,onChange:t.onChange})),r.a.createElement("div",null,"author:",r.a.createElement("input",{type:a.type,value:a.value,onChange:a.onChange})),r.a.createElement("div",null,"url:",r.a.createElement("input",{type:n.type,value:n.value,onChange:n.onChange})),r.a.createElement("button",{type:"submit"},"create")))}),K=r.a.forwardRef(function(e,t){var n=Object(a.useState)(!1),l=Object(s.a)(n,2),o=l[0],u=l[1],c={display:o?"none":""},i={display:o?"":"none"},m=function(){u(!o)};return Object(a.useImperativeHandle)(t,function(){return{toggleVisibility:m}}),r.a.createElement("div",null,r.a.createElement("div",{style:c},r.a.createElement("button",{onClick:m},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{onClick:m},"cancel")))}),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"NEW_MESSAGE":return console.log(t.message),t.message;default:return e}},q=Object(g.b)(function(e){return console.log(e),{blogs:e.blogs,message:e.message,user:e.user}})(function(e){return null===e.message?null:r.a.createElement("div",{className:"success"},e.message)}),H=Object(g.b)(function(e){return{blogs:e.blogs,message:e.message,user:e.user}})(function(e){var t=Object(_.e)().id;return r.a.createElement("div",null,r.a.createElement("h1",null,e.user.name),r.a.createElement("h3",null,"Added blogs"),e.blogs.map(function(e){if(e.user.id==t)return r.a.createElement("li",null,e.title)}))}),P=Object(g.b)(function(e){return console.log(e),{blogs:e.blogs,message:e.message,user:e.user}})(function(e){var t=Object(a.useState)(""),n=Object(s.a)(t,2),l=(n[0],n[1],Object(a.useState)("")),o=Object(s.a)(l,2),u=(o[0],o[1],Object(a.useState)([])),g=Object(s.a)(u,2),d=(g[0],g[1]),f=R("text"),b=R("text"),p=R("text"),y=R("text"),w=R("text"),k=Object(a.useState)(null),S=Object(s.a)(k,2),C=(S[0],S[1]),B=Object(a.useState)(null),x=Object(s.a)(B,2),N=x[0],I=x[1],T=r.a.createRef(),U=Object(a.useState)(0),G=Object(s.a)(U,2),z=G[0],M=G[1];Object(a.useEffect)(function(){var e=[];E().then(function(t){return t.map(function(t){var n=t;e=e.concat(n)})}),d(e)},[]);var V=function(t){var n={title:t.title,author:t.author,url:t.author,likes:t.likes,user:t.user,comments:[]},a=t.id;O(n,a),e.like(a)};Object(a.useEffect)(function(){var t=window.localStorage.getItem("userLogged");if(console.log(t),null!==t&&void 0!==t){var n=JSON.parse(t);e.setU(n),C(n),v(n.token)}},[]),Object(a.useEffect)(function(){e.initializeBlogs()},[]);var P=function(){var t=Object(i.a)(c.a.mark(function t(n){var a;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={title:p.value,author:y.value,url:w.value,comments:[],user:e.user,likes:0},T.current.toggleVisibility(),t.next=5,h(a);case 5:e.setNot("You added "+a.title),e.addNew(a),M(z+1);case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();Object(a.useEffect)(function(){console.log("props bf init",e),e.initializeBlogs(),setTimeout(function(){console.log("props after init",e)},[5e3])},[z]);var Y=function(){window.localStorage.removeItem("userLogged"),e.setU(null)},F=function(t){window.confirm("remove blog"+t.title+"by"+t.author),j(t.id),e.delBlog(t.id)};return null===e.user?r.a.createElement("div",null,r.a.createElement("h2",null,"Login"),r.a.createElement(function(e){var t=e.message;return null===t?null:r.a.createElement("div",{className:"err"},t)},{message:N}),r.a.createElement("form",{onSubmit:function(t){t.preventDefault();var n={username:f.value,password:b.value},a=A(n);console.log("logging in with",f.value,b.value),a.then(function(t){window.localStorage.setItem("userLogged",JSON.stringify(t)),e.setU(t),console.log(t),console.log("bb"),v(t.token),console.log("cc")}).catch(I("Wrong username or password"))}},r.a.createElement("div",null,"username",r.a.createElement("input",{type:f.type,value:f.value,name:"Username",onChange:f.onChange}),r.a.createElement("button",{type:"reset",onClick:f.reset},"reset")),r.a.createElement("div",null,"password",r.a.createElement("input",{"data-testid":"pw",type:b.type,value:b.value,name:"Password",onChange:b.onChange}),r.a.createElement("button",{type:"reset",onClick:b.reset},"reset")),r.a.createElement("button",{type:"submit"},"login"))):r.a.createElement(m.a,null,r.a.createElement(_.a,{exact:!0,path:"/",render:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("form",{onSubmit:Y},r.a.createElement("h3",null,e.user.username+" logged in",r.a.createElement("button",{type:"submit"},"  logout"))),r.a.createElement(q,null),r.a.createElement(K,{buttonLabel:"New blog",ref:T},r.a.createElement(J,{addBlog:P,title:p,url:w,author:y})),e.blogs.map(function(t){return r.a.createElement(D,{deleteBlog:F,key:t.id,user:e.user,blg:t,likeBlog:V})}))}}),r.a.createElement(_.a,{exact:!0,path:"/users",render:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("form",{onSubmit:Y},r.a.createElement("h3",null,e.user.username+" logged in",r.a.createElement("button",{type:"submit"},"  logout"))),r.a.createElement(L,null))}}),r.a.createElement(_.a,{path:"/users/:id",render:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("form",{onSubmit:Y},r.a.createElement("h3",null,e.user.username+" logged in",r.a.createElement("button",{type:"submit"},"  logout"))),r.a.createElement(H,null))}}),r.a.createElement(_.a,{path:"/blogs/:id",render:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("form",{onSubmit:Y},r.a.createElement("h3",null,e.user.username+" logged in",r.a.createElement("button",{type:"submit"},"  logout"))),r.a.createElement(W,null))}}))}),Y=Object(g.b)(null,{setNot:function(e){return function(){var t=Object(i.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"NEW_MESSAGE",message:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},like:k})(P),F=Object(g.b)(null,{addNew:function(e){return console.log(e),function(){var t=Object(i.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"NEW_BLOG",data:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},delBlog:function(e){return function(){var t=Object(i.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"DELETE_BLOG",id:e});case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(Y),Q=Object(g.b)(null,{initializeBlogs:w})(F),X=Object(g.b)(null,{setU:C})(Q),Z=n(15),$=n(37),ee=n(38),te=Object(Z.combineReducers)({message:V,blogs:S,user:B}),ne=Object(Z.createStore)(te,Object($.composeWithDevTools)(Object(Z.applyMiddleware)(ee.a))),ae=function(){o.a.render(r.a.createElement(g.a,{store:ne},r.a.createElement(X,null)),document.getElementById("root"))};ae(),ne.subscribe(ae)}},[[39,1,2]]]);
//# sourceMappingURL=main.631ba25b.chunk.js.map